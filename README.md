# Zone.eu DNS validation plugin for Posh-ACME module

## Description

Zone.eu DNS validation plugin for Posh-ACME powershell module.  
This plugin works against the [Zone](https://www.zone.ee/en/) DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against. 

[Posh-ACME](https://poshac.me/docs/v4/) is a PowerShell module and ACME client to create publicly trusted SSL/TLS certificates from an ACME capable certificate authority such as Let's Encrypt.This module has multiple built-in validation plugins for DNS and HTTP based challenges to prove you control the domain you're requesting a certificate.  
However, only plugins for major providers have been included but you can use your own plugins like this one provided here.


## Table of Contents

- [Installation](#installation)
- [Setup credentials](#setup-credentials)
- [Usage](#usage)
- [Testing](#testing)
- [Documentation and tutorials](#documentation-and-tutorials)

## Installation

It is assumed that you have already [installed](https://poshac.me/docs/v4/#installation-stable) Posh-ACME powershell module and have met [requirements](https://poshac.me/docs/v4/#requirements-and-platform-support).  
To install Zone DNS plugin you need to copy `Zone.ps1` to Plugins folder of Posh-ACME module installation directory.
```powershell
# Module installed to AllUsers scope requires elevated powershell session to be able copy files to module directory
$pluginPath = Join-Path (Split-Path (Get-Module -ListAvailable Posh-ACME).path -Parent) Plugins -Resolve
$sourcePlugin = Get-Item .\Zone.ps1
Copy-Item $sourcePlugin $pluginPath -verbose
```
To validate plugin is correctly installed you can import module and show plugin details
```powershell
Import-Module Posh-ACME -Force
Get-PAPlugin Zone
Get-PAPlugin Zone -Params
```

## Setup credentials

You will need to generate an API Key for [Zone API](https://api.zone.eu/v2) if you haven't already done so.  
The API key can be generated by logging in under "My Zone" on the [Zone web page](https://www.zone.ee/en/) and selecting "Account settings" > "Security" > "APIkeys".  
Make a note of the token value as you'll need it later and won't be able to retrieve it after this point.  
You'll also need your account username.

## Usage

Your account username must used with the `ZnUser` parameter.  
You also need to provide API Key as a SecureString value to `ZnApiKey` parameter.  

**Warning!** The `ZnApiKeyInsecure` parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.

```powershell
$pArgs = @{
    ZnUser = (Read-Host 'Zone User')
    ZnApiKey = (Read-Host 'API Key' -AsSecureString)
}
New-PACertificate example.com -Plugin Zone -PluginArgs $pArgs
```

## Testing

You can test this plugin before actual use with Posh-ACME by creating/removing some TXT records in Zone DNS.  
For testing this plugin follow steps described in [plugin development guide](https://poshac.me/docs/v4/Plugins/Plugin-Development-Guide/#testing-plugins).

## Documentation and tutorials

Used documentation and tutorials

Zone API documentation: https://api.zone.eu/v2  
Zone API authentication guide (only in estonian language): https://help.zone.eu/kb/zone-api/  
Posh-ACME documentation: https://poshac.me/docs/v4/  
Plugin Development Guide: https://poshac.me/docs/v4/Plugins/Plugin-Development-Guide/  
